<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rose Day ðŸŒ¹</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes:wght@400&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100%;
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(135deg, #1a0a1f 0%, #2d1b3d 100%);
            font-family: 'Cinzel', serif;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        #nameDisplay {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Great Vibes', cursive;
            font-size: clamp(24px, 8vw, 72px);
            color: #ffd700;
            text-align: center;
            text-shadow: 
                0 0 10px #ffd700,
                0 0 20px #ff1493,
                0 0 30px #ff69b4,
                0 0 40px #ffd700;
            letter-spacing: 2px;
            animation: glowPulse 3s ease-in-out infinite;
            pointer-events: none;
            z-index: 10;
        }

        #subtitle {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Cinzel', serif;
            font-size: clamp(12px, 3vw, 18px);
            color: #ff69b4;
            text-align: center;
            text-shadow: 0 0 10px #ff69b4;
            pointer-events: none;
            z-index: 10;
            letter-spacing: 3px;
        }

        @keyframes glowPulse {
            0%, 100% {
                text-shadow: 
                    0 0 10px #ffd700,
                    0 0 20px #ff1493,
                    0 0 30px #ff69b4,
                    0 0 40px #ffd700;
            }
            50% {
                text-shadow: 
                    0 0 20px #ffd700,
                    0 0 40px #ff1493,
                    0 0 60px #ff69b4,
                    0 0 80px #ffd700;
            }
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ffd700;
            font-size: 18px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div id="nameDisplay"></div>
    <div id="subtitle">Happy Rose Day</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@r128/examples/js/postprocessing/EffectComposer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@r128/examples/js/postprocessing/RenderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@r128/examples/js/postprocessing/UnrealBloomPass.js"></script>

    <script>
        // ============ PERSONALIZATION ============
        const HER_NAME = "Rose Day Queen";

        // ============ SCENE SETUP ============
        let scene, camera, renderer, composer;
        let rose, petalSystem;
        let windowWidth = window.innerWidth;
        let windowHeight = window.innerHeight;

        function init() {
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0005);

            // Camera
            camera = new THREE.PerspectiveCamera(75, windowWidth / windowHeight, 0.1, 1000);
            camera.position.z = 8;

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(windowWidth, windowHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.body.appendChild(renderer.domElement);

            // Post-processing with Bloom
            composer = new THREE.EffectComposer(renderer);
            const renderPass = new THREE.RenderPass(scene, camera);
            composer.addPass(renderPass);

            const bloomPass = new THREE.UnrealBloomPass(
                new THREE.Vector2(windowWidth, windowHeight),
                1.5,
                0.4,
                0.85
            );
            bloomPass.threshold = 0.21;
            bloomPass.strength = 1.2;
            bloomPass.radius = 0.55;
            composer.addPass(bloomPass);

            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
            scene.add(ambientLight);

            const pointLight1 = new THREE.PointLight(0xff69b4, 1.5, 100);
            pointLight1.position.set(5, 5, 5);
            scene.add(pointLight1);

            const pointLight2 = new THREE.PointLight(0xffd700, 1, 100);
            pointLight2.position.set(-5, -5, 5);
            scene.add(pointLight2);

            const pointLight3 = new THREE.PointLight(0xff1493, 0.8, 100);
            pointLight3.position.set(0, 8, 0);
            scene.add(pointLight3);

            // Create Rose
            rose = createRose();
            scene.add(rose);

            // Create Petal Particle System
            petalSystem = createPetalSystem();
            scene.add(petalSystem);

            // Update name display
            document.getElementById('nameDisplay').textContent = HER_NAME;

            // Event listeners
            window.addEventListener('resize', onWindowResize, false);

            // Animation loop
            animate();
        }

        // ============ CREATE PROCEDURAL ROSE ============
        function createRose() {
            const rose = new THREE.Group();

            // Create stem
            const stemGeometry = new THREE.CylinderGeometry(0.1, 0.15, 6, 16);
            const stemMaterial = new THREE.MeshStandardMaterial({
                color: 0x2d5016,
                roughness: 0.8,
                metalness: 0.2
            });
            const stem = new THREE.Mesh(stemGeometry, stemMaterial);
            stem.position.y = -3;
            stem.castShadow = true;
            stem.receiveShadow = true;
            rose.add(stem);

            // Create petals using a spiral approach
            const petalCount = 200;
            const petalGroup = new THREE.Group();

            for (let i = 0; i < petalCount; i++) {
                const petal = createPetal(i, petalCount);
                petalGroup.add(petal);
            }

            petalGroup.position.y = 1.5;
            rose.add(petalGroup);

            // Rotate group for better presentation
            rose.rotation.x = -0.3;

            return rose;
        }

        function createPetal(index, total) {
            const u = index / total;
            const v = Math.random();

            // Parametric rose surface
            const phi = u * Math.PI * 12;
            const theta = v * Math.PI;

            const k = 5;
            const r = Math.cos(k * phi / 2);
            const amplitude = Math.sin(theta) * r * 0.5;

            const x = amplitude * Math.cos(phi) * Math.sin(theta) * 1.5;
            const y = amplitude * Math.sin(phi) * Math.sin(theta) * 1.5;
            const z = Math.cos(theta) * r * 0.8;

            // Create petal geometry
            const geometry = new THREE.SphereGeometry(0.15, 8, 8);

            // Custom shader for velvety texture
            const material = new THREE.ShaderMaterial({
                uniforms: {
                    color: { value: new THREE.Color(0xff1493 + Math.random() * 0x00aa00) }
                },
                vertexShader: `
                    varying vec3 vNormal;
                    varying vec3 vPosition;

                    void main() {
                        vNormal = normalize(normalMatrix * normal);
                        vPosition = position;
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                    }
                `,
                fragmentShader: `
                    uniform vec3 color;
                    varying vec3 vNormal;
                    varying vec3 vPosition;

                    void main() {
                        vec3 normal = normalize(vNormal);
                        float velvet = pow(length(cross(normal, vec3(0.0, 1.0, 0.0))), 2.0) * 0.8;
                        vec3 finalColor = color * (0.6 + velvet * 0.4);
                        gl_FragColor = vec4(finalColor, 1.0);
                    }
                `
            });

            const petal = new THREE.Mesh(geometry, material);
            petal.position.set(x, y, z);
            petal.scale.set(
                0.8 + Math.sin(index * 0.1) * 0.3,
                0.9 + Math.cos(index * 0.15) * 0.4,
                0.7 + Math.sin(index * 0.2) * 0.2
            );
            petal.rotation.set(
                Math.random() * Math.PI,
                Math.random() * Math.PI,
                Math.random() * Math.PI
            );
            petal.castShadow = true;
            petal.receiveShadow = true;

            return petal;
        }

        // ============ PETAL PARTICLE SYSTEM ============
        function createPetalSystem() {
            const particleCount = 2000;
            const particles = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            const velocities = new Float32Array(particleCount * 3);

            for (let i = 0; i < particleCount; i++) {
                const i3 = i * 3;

                positions[i3] = (Math.random() - 0.5) * 60;
                positions[i3 + 1] = Math.random() * 40;
                positions[i3 + 2] = (Math.random() - 0.5) * 40;

                velocities[i3] = (Math.random() - 0.5) * 0.1;
                velocities[i3 + 1] = -0.05 - Math.random() * 0.15;
                velocities[i3 + 2] = (Math.random() - 0.5) * 0.1;
            }

            particles.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particles.setAttribute('velocity', new THREE.BufferAttribute(velocities, 3));

            const particleMaterial = new THREE.PointsMaterial({
                size: 0.15,
                color: 0xff69b4,
                transparent: true,
                opacity: 0.6,
                sizeAttenuation: true
            });

            const particleSystem = new THREE.Points(particles, particleMaterial);
            particleSystem.userData.velocities = velocities;

            return particleSystem;
        }

        // ============ ANIMATION LOOP ============
        function animate() {
            requestAnimationFrame(animate);

            // Rotate rose
            if (rose) {
                rose.rotation.z += 0.002;
                rose.children[1].rotation.y += 0.003;
            }

            // Animate particles
            if (petalSystem) {
                const positions = petalSystem.geometry.attributes.position.array;
                const velocities = petalSystem.userData.velocities;

                for (let i = 0; i < positions.length; i += 3) {
                    // Wind simulation
                    const windForce = Math.sin(Date.now() * 0.0003 + positions[i]) * 0.02;

                    positions[i] += velocities[i] + windForce;
                    positions[i + 1] += velocities[i + 1];
                    positions[i + 2] += velocities[i + 2];

                    // Wrap around
                    if (positions[i + 1] < -10) {
                        positions[i + 1] = 40;
                        positions[i] = (Math.random() - 0.5) * 60;
                    }

                    // Swirl effect
                    velocities[i] += Math.sin(Date.now() * 0.0002 + positions[i]) * 0.001;
                }

                petalSystem.geometry.attributes.position.needsUpdate = true;
            }

            // Render with bloom
            composer.render();
        }

        // ============ RESPONSIVE HANDLING ============
        function onWindowResize() {
            windowWidth = window.innerWidth;
            windowHeight = window.innerHeight;

            camera.aspect = windowWidth / windowHeight;
            camera.updateProjectionMatrix();

            renderer.setSize(windowWidth, windowHeight);
            composer.setSize(windowWidth, windowHeight);
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
